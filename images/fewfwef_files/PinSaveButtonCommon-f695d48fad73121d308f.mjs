(window.__LOADABLE_LOADED_CHUNKS__=window.__LOADABLE_LOADED_CHUNKS__||[]).push([["PinSaveButtonCommon","sterlingAPI"],{"2qKt":function(e,t,n){var a=n("q1tI"),s=n("/MKj"),i=(n("17x9"),n("/5zs")),r=n("Vzit"),o=n("vh5K"),c=n("pLLR"),l=n("fArA");function u(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const d={shouldUsePlacedExperience:!0,dispatchMountActionDuringSSR:!1};t.a=(e,t={},n)=>h=>{const p=function(e){return t=>{return{experience:t.experiences.eligibleExperiences[e]}}}(e);n=Object.assign({},d,n);const m=function(e,t,n=!0,s=!0,c){return class extends a.Component{constructor(e){super(e),u(this,"state",{extraContext:void 0}),u(this,"setExtraContextState",e=>this.setState({extraContext:e}))}componentDidMount(){this.dispatchPlacementMount(!1)}UNSAFE_componentWillUpdate(n,a){const{dispatch:s,experience:c,requestContext:l}=n,u=new i.c(l,"web_bypass_eligible_experience").enabledWithNoActivation();let d=t;if(u&&"function"==typeof t){const i=t(this.props,this.state);d=t(n,a.extraContext||{}),JSON.stringify(i)!==JSON.stringify(d)&&s(Object(r.c)(e,d,u))}else{if("function"==typeof t){const e=a.extraContext||{};d=t(n,e)}if(!Object(o.d)(c)&&"function"==typeof t&&d&&Object.keys(d).length){const n=t(this.props,this.state);JSON.stringify(n)!==JSON.stringify(d)&&s(Object(r.c)(e,d))}}!c||this.props.experience&&c.id===this.props.experience.id||s(Object(r.i)(e,d))}componentWillUnmount(){const{dispatch:t}=this.props;t(Object(r.k)(e))}dispatchPlacementMount(n){const{dispatch:a,requestContext:s}=this.props;let o={};o="function"==typeof t?t(this.props,this.state):Object.assign({},t);const c=!n&&new i.c(s,"web_bypass_eligible_experience").enabled();a(Object(r.j)(e,o,n,c))}render(){const{experience:e}=this.props;return a.createElement(c,Object.assign({},this.props,{setPlacementExtraContext:this.setExtraContextState,experience:Object(o.d)(e)?e:null}))}}}(e,t,n.shouldUsePlacedExperience,n.dispatchMountActionDuringSSR,h);return Object(l.compose)(c.f,Object(s.connect)(p))(m)}},"5uyJ":function(e,t,n){n.d(t,"a",(function(){return a}));const a={V_HLSV4:"V_HLSV4",V_720P:"V_720P"}},"82UD":function(e,t,n){var a=n("q1tI"),s=n.n(a),i=n("/MKj"),r=n("ajUs"),o=n("ou9u"),c=n("gYog"),l=n("hFNL"),u=n("3gA6"),d=n("yKES"),h=n("5uyJ"),p=n("n6mq");const m={overlay:{__style:{backgroundColor:"#000"}}};function f(e){const{pin:{id:t,images:n,title:a,videos:i,video_status_message:r}}=e,o=r||{},c=n&&n["236x"],l=i&&i.video_list[h.a.V_HLSV4],{duration:f}=l||{};return s.a.createElement(s.a.Fragment,null,s.a.createElement(p.e,null,s.a.createElement(u.b,{to:`/pin/${t}`},s.a.createElement(p.c,{overflow:"hidden",position:"relative",rounding:2},c&&s.a.createElement(p.p,{alt:a||"",color:"lightGray",naturalHeight:c.height,naturalWidth:c.width,src:c.url}),!!f&&s.a.createElement(p.c,{padding:2,position:"absolute",bottom:!0,left:!0,display:"flex"},s.a.createElement(d.a,{duration:f})),s.a.createElement(p.c,{position:"absolute",top:!0,bottom:!0,left:!0,right:!0,opacity:.4,dangerouslySetInlineStyle:m.overlay}),s.a.createElement(p.c,{position:"absolute",top:!0,left:!0,padding:5,width:"100%"},s.a.createElement(p.m,{color:"white",overflow:"normal",size:"sm"},o.title),s.a.createElement(p.c,{marginTop:4},s.a.createElement(p.K,{color:"white",size:"md",overflow:"normal"},o.subtitle)))),s.a.createElement(p.c,{display:"flex",alignItems:"start",justifyContent:"between",marginTop:1,paddingX:1},s.a.createElement(p.c,{flex:"grow"},a&&s.a.createElement(p.c,{paddingY:1},s.a.createElement(p.K,{inline:!0,size:"md",weight:"bold"},a)))))))}var b=n("Y8Sn"),g=n("vpxy"),v=n("0nTG");t.a=Object(i.connect)((function({pins:e},{pin:t,pinId:n}){return{reduxPin:e[n]||t}}),()=>({}))((function({reduxPin:e,trackingParameters:t,...n}){const u=Object(i.useSelector)(({location:e})=>e),d=Object(r.a)(e,u),h=Object(o.a)(e),p=!!(h&&h.url&&h.height&&h.width)||void 0,m=h&&e.videos?e.videos.id:void 0,[_,y]=Object(a.useState)(!1),S=Object(a.useCallback)(()=>y(!0),[]),C=Object(a.useCallback)(()=>y(!1),[]),{componentType:E,contextLogData:x,impressionAuxFields:w,slotIndex:O,viewData:P,viewParameter:D,viewType:j}=t;return s.a.createElement(c.a,{componentType:E,contextLogData:{..."undefined"!=typeof window?{pwa_type:Object(l.b)(window)}:{},...x,...Object(v.a)(e,x)},impressionAuxFields:{...w||{},isNativeVideoAndWatchable:p,videoIdStr:m,clientTrackingParams:d||`${e.tracking_params||""}-0`,imageURL:e.images&&e.images["236x"].url,richTypes:Object(v.c)(e)},impressionType:"Pin",isPaused:!_,loggingId:e.id,slotIndex:O,viewData:P,viewParameter:D,viewType:j},Object(b.e)(e)?s.a.createElement(f,{pin:e}):s.a.createElement(g.a,Object.assign({},n,{debugImpressionState:_?"started":"paused",onError:C,onLoad:S,pin:e,trackingParameters:{componentType:E,contextLogData:x,slotIndex:O,viewParameter:D,viewType:j}})))}))},Ev07:function(e,t,n){var a=n("1inl"),s=n("UTsl"),i=n("Ye/N"),r=n("mBfy");const o={checkFbTimelinePermission:function(e){s.default.ensureInit((function(t){t.api("/me/permissions",t=>{const n=t.data;let a=!1;if(n){a=!!n.find(e=>"publish_actions"===e.permission&&"granted"===e.status)}a?e.success&&e.success():e.error&&e.error()})}),r.default)},fbConnectedAccountMatchesLoggedInAccount:function(e,t){if(!t)return!0;const n=e.getAuthResponse();return!n||t===n.userID},maybeRequestFbTimelinePermission:function(e,t){s.default.ensureInit(n=>{if(!o.fbConnectedAccountMatchesLoggedInAccount(n,t))return a.a.showError(i.a._("Oops! Your account is linked to a different Facebook account than the one you're logged into now.")),e.error&&e.error(),void(e.complete&&e.complete());o.checkFbTimelinePermission({success(){e.success&&e.success(),e.complete&&e.complete()},error(){o.fbLogin(e)}})},r.default)},fbLogin:function(e){s.default.ensureInit(t=>{t.login(t=>{t.authResponse?o.checkFbTimelinePermission(e):e.error&&e.error(),e.complete&&e.complete()},{scope:"publish_actions"})},r.default)},getLocaleString:function(e){let t=e;switch(t=t.replace(/-/g,"_")){case"de":t="de_DE";break;case"fr":t="fr_FR";break;case"it":t="it_IT";break;case"ja":t="ja_JP";break;case"nl":t="nl_NL";break;case"tr":t="tr_TR";break;case"en_AU":t="en_US"}return t.startsWith("es")&&(t="es_LA"),t.startsWith("ar")&&(t="ar_AR"),t}};t.a=o},MhBu:function(e,t,n){function a(e){return{type:"FEED_ITEMS_REMOVED",payload:e}}n.d(t,"a",(function(){return a}))},P6kd:function(e,t,n){var a=n("q1tI"),s=n.n(a),i=n("Ye/N"),r=n("oRao"),o=n("eOdZ"),c=n("vxan"),l=n("vvax"),u=n("n6mq");function d(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const h=5,p=27,m=38,f=40,b=13;t.a=Object(c.a)(class extends s.a.Component{constructor(...e){super(...e),d(this,"state",{isOpen:this.props.editing,recommendations:[],selectedIndex:0,resourceLoaded:!1}),d(this,"onDismiss",()=>{this.setState({isOpen:!1})}),d(this,"mounted",!1),d(this,"addHashtag",e=>{this.props.addHashtag(e),this.setState({recommendations:[]})}),d(this,"handleKeyDown",e=>{e.keyCode===m?this.handlePrevHashtag(e):e.keyCode===f?this.handleNextHashtag(e):e.keyCode===p?this.handleClose(e):e.keyCode===b&&this.handleSubmit(e)}),d(this,"handlePrevHashtag",e=>{e.preventDefault(),this.state.selectedIndex>0&&this.setState(e=>({selectedIndex:e.selectedIndex-1}))}),d(this,"handleNextHashtag",e=>{e.preventDefault(),this.state.selectedIndex<this.state.recommendations.length-1&&this.setState(e=>({selectedIndex:e.selectedIndex+1}))}),d(this,"handleClose",e=>{e.preventDefault(),this.setState({recommendations:[]})}),d(this,"handleSubmit",e=>{e.preventDefault(),this.addHashtag(this.state.recommendations[this.state.selectedIndex].query)}),d(this,"callResource",e=>{const{makeCancelablePromise:t}=this.props;t(o.a.create("HashtagTypeaheadResource",{query:e,showPinCount:!0}).callGet(),"typeahead").then(e=>{if(!this.mounted)return;const t=e.resource_response.data;this.setState({recommendations:t.slice(0,h),resourceLoaded:!0})}).catch(({isCanceled:e})=>{e||this.setState({resourceLoaded:!1})})})}componentDidMount(){this.mounted=!0,this.callResource(this.props.query),window.addEventListener("keydown",this.handleKeyDown)}UNSAFE_componentWillReceiveProps(e){e.query!==this.props.query&&""!==e.query&&this.callResource(e.query)}componentWillUnmount(){window.removeEventListener("keydown",this.handleKeyDown),this.mounted=!1}render(){const{recommendations:e,resourceLoaded:t,selectedIndex:n}=this.state,{anchor:a,idealDirection:o}=this.props,c=e.filter(e=>e.query),d=o||"down",h="flyout_"+c.length;return t&&c.length>0?s.a.createElement("div",{className:"HashtagFlyout"},s.a.createElement(u.k,{key:h,anchor:a,idealDirection:d,onDismiss:this.onDismiss,size:"sm"},s.a.createElement("div",{className:"HashtagRecommendations"},c.length>0?c.map((e,t)=>s.a.createElement("div",{className:"HashtagItem",key:e.query},s.a.createElement(u.P,{onTouch:t=>this.addHashtag(e.query),fullWidth:!1},s.a.createElement(u.c,{display:"flex",justifyContent:"between",alignItems:"center",color:t===n?"lightGray":"transparent",padding:1},s.a.createElement(u.c,{flex:"grow"},s.a.createElement(u.K,{inline:!0,size:"md",weight:"bold"},e.query)),s.a.createElement(u.c,{flex:"none"},s.a.createElement(u.K,{inline:!0,size:"sm"},Object(l.b)(i.a.ngettext("{{ count }} pin","{{ count }} pins",Number(e.pin_count),"label for n pins in hashtag flyout","label for n pins in hashtag flyout"),{count:s.a.createElement(r.a,{value:Number(e.pin_count),key:"pinCount"})}))))))):null))):null}})},PNKV:function(e,t,n){},WnNx:function(e,t,n){function a(e){return{type:"SHOW_REPIN_ANIMATION",payload:{pinId:e}}}function s(){return{type:"HIDE_REPIN_ANIMATION"}}function i(){return{type:"SHOW_USECASE_FLYOUT"}}function r(){return{type:"HIDE_USECASE_FLYOUT"}}n.d(t,"c",(function(){return a})),n.d(t,"a",(function(){return s})),n.d(t,"d",(function(){return i})),n.d(t,"b",(function(){return r}))},c50B:function(e,t,n){n.d(t,"n",(function(){return s})),n.d(t,"d",(function(){return i})),n.d(t,"e",(function(){return r})),n.d(t,"a",(function(){return o})),n.d(t,"m",(function(){return c})),n.d(t,"i",(function(){return l})),n.d(t,"l",(function(){return u})),n.d(t,"p",(function(){return d})),n.d(t,"j",(function(){return h})),n.d(t,"f",(function(){return p})),n.d(t,"g",(function(){return m})),n.d(t,"h",(function(){return f})),n.d(t,"b",(function(){return b})),n.d(t,"c",(function(){return g})),n.d(t,"r",(function(){return v})),n.d(t,"o",(function(){return _})),n.d(t,"k",(function(){return y})),n.d(t,"q",(function(){return S})),n.d(t,"s",(function(){return C}));const a=e=>{const t={"０":"0","１":"1","２":"2","３":"3","４":"4","５":"5","６":"6","７":"7","８":"8","９":"9","　":" "},n=String(e).split("");return n.forEach((e,a)=>{const s=t[e];s&&(n[a]=s)}),n.join("")};function s(e){return function(t,n){const a=[];t&&/\S/.test(t)||a.push(e.message);const s={errors:a,warnings:[]};return n&&n(s),s}}const i=new RegExp(["(^[-!#$%&'*+/=?^_`{}|~0-9A-Z]+(\\.[-!#$%&'*+/=?^_`{}|~0-9A-Z]+)*",'|^"([\\001-\\010\\013\\014\\016-\\037!#-\\[\\]-\\177]|\\\\[\\001-\\011\\013\\014\\016-\\177])*"',")@((?:[A-Z0-9](?:[A-Z0-9-]{0,61}[A-Z0-9])?\\.)+[A-Z]{2,20}$)","|\\[(25[0-5]|2[0-4]\\d|[0-1]?\\d?\\d)(\\.(25[0-5]|2[0-4]\\d|[0-1]?\\d?\\d)){3}\\]$"].join(""),"i");function r(e){return function(t,n){const a=[];(t=t&&t.trim())&&!t.match(i)&&a.push(e.message);const s={errors:a,warnings:[]};return n&&n(s),s}}function o(e){return function(t,n){const s=a(t.trim()),i=[];s&&""!==s&&s.length<2&&i.push(e.ageTooShortString);const r=Math.floor(parseInt(s,10));""===s||/^\d+$/.test(s)&&r>0&&r<300||i.push(e.invalidAgeString);const o={errors:i,warnings:[]};return n&&n(o),o}}function c(e){return function(t,n){const a=(t=t&&t.trim()).replace(/[\(\)\+\-\. ]/g,""),s=[],i=!1!==e.checkLength&&a.length<7;!t||t.match(/^(\(?\+?[0-9]*\)?)?[0-9_\- \.\(\)]*$/g)&&!i||s.push(e.message);const r={errors:s,warnings:[]};return n&&n(r),r}}function l(e){return function(t,n){const s=/^\d+$/,i=[];"number"==typeof t||"string"==typeof t&&(t=t&&t.trim(),(t=a(t))&&!t.match(s)&&i.push(e.message));const r={errors:i,warnings:[]};return n&&n(r),r}}function u(e){return function(t,n){const s=/^[\d\ -]+$/,i=[];"number"==typeof t||"string"==typeof t&&(t=t&&t.trim(),(t=a(t))&&!t.match(s)&&i.push(e.message));const r={errors:i,warnings:[]};return n&&n(r),r}}function d(e){return function(t,n){const a=[];t&&!t.match(/^(https?:\/\/){0,1}[a-z0-9_\-]+\..+/gi)&&a.push(e.message);const s={errors:a,warnings:[]};return n&&n(s),s}}function h(e){return function(t,n){const a=[];(e.should_trim||!1)&&(t=t&&t.trim());const s=t.length;e.min&&s<e.min?a.push(e.minErrorString):e.max&&s>e.max&&a.push(e.maxErrorString);const i={errors:a,warnings:[]};return n&&n(i),i}}function p(e){return function(t,n){const a=[];t!==(e&&e.targetValue)&&a.push(e.message);const s={errors:a,warnings:[]};return n&&n(s),s}}function m(e){return function(t,n){t&&(t=parseFloat(t));const a=[];t<=e.value&&a.push(e.message);const s={errors:a,warnings:[]};return n&&n(s),s}}function f(e){return function(t,n){t&&(t=parseFloat(t));const a=[];t<e.value&&a.push(e.message);const s={errors:a,warnings:[]};return n&&n(s),s}}function b(e){return function(t,n){const a=[];/^[\040-\176]*$/.test(t)||a.push(e.message);const s={errors:a,warnings:[]};return n&&n(s),s}}function g(e){return function(t,n){const a=e.hasFractionalCents?/^\d*(\.\d\d?\d?)?$/:/^\d*(\.\d\d?)?$/,s=[];"number"==typeof t&&(t=t.toString()),t&&!t.match(a)&&(t=t&&t.trim(),s.push(e.message));const i={errors:s,warnings:[]};return n&&n(i),i}}function v(e){return function(t,n){t=t&&t.trim();const a=[],s=new Date(t);t&&!s.getTime()&&a.push(e.message);const i={errors:a,warnings:[]};return n&&n(i),i}}function _(e){return function(t,n){const a=[];(t=t&&t.trim())&&!t.match(/^([01]?[0-9]|2[0-3]):[0-5][0-9]$/)&&a.push(e.message);const s={errors:a,warnings:[]};return n&&n(s),s}}function y(e){return function(t,n){const a=[];e.pattern.test(t)||a.push(e.message);const s={errors:a,warnings:[]};return n&&n(s),s}}function S(e,t){const n=e.map(e=>e(t).errors);return[].concat(...n)}function C(e,t){let n="";return t.some(t=>{const a=t(e);return a.errors.length>0&&(n=a.errors[0],!0)}),n}},dMCU:function(e,t,n){n.d(t,"a",(function(){return c}));var a=n("q1tI"),s=n.n(a),i=n("/MKj"),r=n("v/Q4"),o=n("+PUW");function c(e){const t=t=>{const n=Object(i.useDispatch)(),{isAuth:a,isLimitedLogin:c}=Object(r.a)(),l=!a||c?e=>e=>{e&&e.stopPropagation(),n(o.b)}:e=>e;return s.a.createElement(e,Object.assign({authAction:l,dispatch:n,isAuth:a,isLimitedLogin:c},t))};return t.displayName=`WithAuthenticatedAction(${String(e.displayName||e.name)})`,t}},jZhD:function(e,t,n){n.d(t,"a",(function(){return r}));var a=n("q1tI"),s=(n("17x9"),n("pdBG"));function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class r extends a.Component{constructor(...e){super(...e),i(this,"searchCache",Object.create(null)),i(this,"lastSearchedQuery",null),i(this,"search",e=>{this.lastSearchedQuery=e,e in this.searchCache?this.props.onTypeaheadSuggestionsChange(this.searchCache[e],e):this.provider.search(e,({items:t})=>{this.searchCache[e]=t,e===this.lastSearchedQuery&&this.props.onTypeaheadSuggestionsChange(t,e)})})}componentDidMount(){const e=this.props.resourceOptions||{};this.provider=new s.a({resource_name:this.props.resourceName,...e});const{value:t}=this.props;null!=t&&this.props.allowSearchOnMount&&this.search(this.props.value)}UNSAFE_componentWillReceiveProps({value:e}){null!=e&&e!==this.props.value&&this.search(e)}render(){return this.props.children||null}}i(r,"defaultProps",{resourceName:"TypeaheadResource"})},"l/PN":function(e,t,n){},mEMi:function(e,t,n){n.d(t,"a",(function(){return u}));var a=n("q1tI"),s=n.n(a),i=n("DzJC"),r=n.n(i);function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const c=200,l=({scrollTop:e,clientHeight:t,scrollHeight:n},a)=>{return e+t+(a?a(t):2*t)>n};class u extends s.a.PureComponent{constructor(...e){super(...e),o(this,"setContainerRef",e=>{this.containerRef=e}),o(this,"fetchMoreIfNecessary",r()(()=>{const{fetchMore:e,scrollBuffer:t}=this.props;e&&this.containerRef&&l(this.containerRef,t)&&e()},c))}componentDidMount(){setTimeout(this.fetchMoreIfNecessary)}componentDidUpdate(){this.fetchMoreIfNecessary()}render(){const{children:e}=this.props;return e({onScroll:this.fetchMoreIfNecessary,setRef:this.setContainerRef})}}},mvLR:function(e,t,n){function a(e){let t=!1;return{promise:new Promise((n,a)=>{e.then(e=>t?a({isCanceled:!0}):n(e),e=>a(t?{isCanceled:!0}:e))}),cancel(){t=!0}}}n.d(t,"a",(function(){return a}))},ou9u:function(e,t,n){function a(e){const t=e.videos&&e.videos.video_list&&Object.keys(e.videos.video_list).length>0?e.videos.video_list:null;return t?t.V_HLSV3_MOBILE||t.V_HLSV4||t.V_720P:null}n.d(t,"a",(function(){return a}))},pdBG:function(e,t,n){var a=n("AHhP"),s=n.n(a);const i=function(e,t){this.uid=e,this.item=t,this.next=null,this.prev=null},r=function(e){this._maxNumItems=e||10,this._uidToData={},this._numItems=0,this._firstData=null,this._lastData=null};r.prototype.set=function(e,t){let n=this._uidToData[e];n||(n=new i(e,t),this._uidToData[e]=n,this._numItems+=1),this._moveToFront(n),this._numItems>this._maxNumItems&&this._evict()},r.prototype.get=function(e){const t=this._uidToData[e];return t?(this._moveToFront(t),t.item):null},r.prototype.remove=function(e){const t=this._uidToData[e];t&&(delete this._uidToData[e],this._firstData===t&&(this._firstData=t.next),this._lastData===t&&(this._lastData=t.prev),t.prev&&(t.prev.next=t.next),t.next&&(t.next.prev=t.prev),this._numItems-=1)},r.prototype._moveToFront=function(e){this._firstData!==e&&(this._firstData?(this._lastData===e&&(this._lastData=e.prev),e.prev&&(e.prev.next=e.next),e.next&&(e.next.prev=e.prev),this._firstData.prev=e,e.next=this._firstData,e.prev=null,this._firstData=e):(this._firstData=e,this._lastData=e))},r.prototype._evict=function(){delete this._uidToData[this._lastData.uid],this._firstData===this._lastData?(this._firstData=null,this._lastData=null):(this._lastData=this._lastData.prev,this._lastData.next=null),this._numItems-=1};var o=r,c=n("eOdZ"),l=n("mBfy");const u=function(e){e=e||{},this.tags=e.tags,this.enable_recent_queries=!!e.enable_recent_queries,this.minimum_term_character_length=e.minimum_term_character_length||0,this.bypass_lru_cache=e.bypass_lru_cache;const t={tags:e.tags,pin:e.pin_id},n=e.num_places;n?t.num_places=n:t.count="count"in e?e.count:5,e.exclude_non_followers&&(t.exclude_non_followers=!0),e.field_set_key&&(t.field_set_key=e.field_set_key),e.pin_scope&&(t.pin_scope=e.pin_scope),e.suggestion_type&&(t.suggestion_type=e.suggestion_type);let a="TypeaheadResource";e.resource_name&&(a=e.resource_name),this.searchResource=c.a.create(a,t),this.itemsCache=new o};Object.assign(u.prototype,s.a),Object.assign(u.prototype,{search(e,t){let n;if(!e&&"pinners_and_contacts"===this.tags)return this.abortSearch(),this.publishData(e,[],{},t);if(!e&&l.default.isLimitedLogin())return this.abortSearch(),this.publishData(e,[],{},t);if(!e&&this.enable_recent_queries&&l.default&&l.default.isAuthenticated())n="recent_search";else{const n=this.bypass_lru_cache?{}:this.itemsCache.get(e);if(n){const a=n.items;if(a&&a.length){this.abortSearch();const s=n.hint;return void this.publishData(e,a,s,t)}}}e.length>=this.minimum_term_character_length?this.fetch(e,n,t):this.publishData(e,[],{},t)},getResource(){return this.searchResource},abortSearch(){this.getResource().abort()},publishData(e,t,n,a){const s={term:e,items:t,hint:n};this.trigger("data",s),a&&a(s)},setAutocompleteScope(e){this.getResource().set("autocompleteScope",e)},fetch(e,t,n){const a=this.getResource();if(a.isCalling()){const t=a.get("term");if(e===t)return;this.abortSearch()}""!==this.tags&&(a.set("term",e),a.set("tags",t||this.tags),a.resetBookmark(),a.callGet({showError:!1}).then(t=>{const a=t.resource_response.data,s=a.items,i=a.hint||{},r={hint:i,items:s};this.cacheData(e,r),this.publishData(e,s,i,n)},e=>{this.trigger("fetchError",e)}),this.warm=!0)},removeCacheForTerm(e){this.itemsCache.remove(e)},cacheData(e,t){this.itemsCache.set(e,t)},prefetch(){if(this.warm)return;c.a.create("TypeaheadPrepareResource").callGet({showError:!1}),this.warm=!0}});t.a=u},rO08:function(e,t,n){n.r(t),n.d(t,"PinSaveButton",(function(){return x}));var a=n("q1tI"),s=n.n(a),i=n("/MKj"),r=(n("l/PN"),n("Ye/N")),o=n("TiQD"),c=n("rYoy"),l=n("y9Ij"),u=n("dMCU"),d=n("n02X"),h=n("2qKt"),p=n("n6mq"),m=n("0nTG"),f=n("lm6u"),b=n("C0mq"),g=n("B6Tf"),v=n("oTtT"),_=n("pLLR"),y=n("fArA");function S(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const C=Object(a.lazy)(()=>n.e("FirstPinCreateCommon").then(n.bind(null,"kj35"))),E=[500639,11022];class x extends a.Component{constructor(e){super(e),S(this,"componentWillUnmount",()=>{this._repinCompletionPromise&&this._repinCompletionPromise.cancel()}),S(this,"setCompletionPromise",e=>{this._repinCompletionPromise=e,this._repinCompletionPromise.promise.then(()=>{this.handleRepinHideAndToggle()})}),S(this,"_repinCompletionPromise",null),S(this,"handleRepinHide",()=>{this.setState({isRepinModalOpen:!1})}),S(this,"handleRepinHideAndToggle",()=>{this.setState({isRepinModalOpen:!1});const{onToggleModal:e}=this.props;e&&e(!1)}),S(this,"handleSaveButtonClick",this.props.authAction(e=>{e&&(e.preventDefault(),e.stopPropagation());const{onClickCallback:t,onToggleModal:n,oneTapSave:a,boardPickerStopwatch:s}=this.props;t&&t(),a?a.saved||"function"!=typeof a.save||a.save():(s&&s.start(),n&&n(!0),this.setState({isRepinModalOpen:this.props.isAuth}))})),S(this,"handleSavedButtonClick",()=>{const{history:e,pin:t,pinSavedInfo:n,viewerId:a}=this.props;let s;t.pinner.id===a?s=t.board.url:n&&(s=n.url),s&&e.push(s)}),S(this,"saveButtonRef",Object(a.createRef)()),S(this,"renderPinToBoardRepin",()=>{const{isCloseupPin:e,onToggleModal:t,pin:n}=this.props,{isFPE:a,isRepinModalOpen:i}=this.state;return i&&a?this.renderFPE():a?null:s.a.createElement(f.a,{action:"repin",additionalCreateFields:{is_stl_pin:Object(m.f)(n)},onClose:this.handleRepinHide,setCompletionPromise:this.setCompletionPromise,shouldShowToast:!0,onToggleModal:t,pin:n},({dismissModal:a,displaySuccessAnimation:r,handleAbort:o,handleNewBoardAnimationCompletion:c,handleSocialConnectSet:l,handleSaveToBoard:u,newPin:d,updateDescription:h,modalTitle:p,setModalTitle:m})=>s.a.createElement(g.b,{dismissModal:a,displaySuccessAnimation:r,handleSocialConnectSet:l,handleSaveToBoard:u,anchorRef:this.saveButtonRef.current,handleAbort:o,handleNewBoardAnimationCompletion:c,newPin:d,isCloseupPin:e,isInModal:!0,onToggleModal:t,pin:n,pwtAuxData:{pin_create_method:"repin"},modalTitle:p,setModalTitle:m,shouldRenderContent:i,updateDescription:h}))});const{experience:t,showRepinOnInitialRender:n}=e;this.state={isFPE:!!t&&E.includes(t.experience_id),isRepinModalOpen:n||!1}}componentDidMount(){const{onMount:e}=this.props;e&&e()}shouldComponentUpdate(e,t){return!this.isFPERemoved(e)}isFPERemoved(e){const{isFPE:t}=this.state,{experience:n}=e;return t&&(!n||!E.includes(n.experience_id))}renderFPE(){const{completePinSave:e,experience:t,pin:n}=this.props;return s.a.createElement(o.b,{accessibilityModalLabel:r.a._("Create board","Accessible create board education modal label","Accessible create board education modal label"),footer:s.a.createElement("div",{className:"FirstBoardCreate__education"},r.a._("Boards are where you save your Pins","Text explaining that boards are used to collect and save pins","Text explaining that boards are used to collect and save pins")),heading:r.a._("Create board","Create board education modal label","Create board education modal label"),onDismiss:this.handleRepinHideAndToggle,size:"lg"},s.a.createElement(c.a,null,s.a.createElement(C,{anchorRef:this.saveButtonRef.current,experience:t,isInModal:!0,onClose:this.handleRepinHideAndToggle,onComplete:e,pin:n,pwtAuxData:{pin_create_method:"repin"}})))}render(){const{anchorString:e,icon:t,iconOnly:n,isCloseupPin:i,oneTapSave:r,pin:o,renderPinSaveTooltip:c,requestContext:u,variant:h,viewerId:m}=this.props,f=Object(d.a)(e||"")(l.a),b=!!(o.pinner.id===m||o.saved||o.savedInfo||"controlled"===(null==r?void 0:r.type)&&r.saved),g="controlled"===(null==r?void 0:r.type)?"controlled":"classic";return s.a.createElement(a.Fragment,null,s.a.createElement(p.c,{ref:this.saveButtonRef},s.a.createElement(f,{icon:t,iconOnly:n,isCloseupPin:i,isPulsarDisplayed:!this.state.isRepinModalOpen,onClick:this.handleSaveButtonClick,onSavedClick:this.handleSavedButtonClick,requestContext:u,saveButtonType:g,saved:b,variant:h}),this.renderPinToBoardRepin()),!!c&&this.saveButtonRef.current&&c(this.saveButtonRef.current))}}S(x,"defaultProps",{anchorString:""}),t.default=Object(y.compose)(Object(i.connect)((function({pins:e,viewer:t},{pin:n}){return{email:t.isAuth?t.email:void 0,isAuth:t.isAuth,pinSavedInfo:e[n.id].savedInfo,viewerId:t.isAuth?t.id:""}}),(function(e){return{completePinSave:()=>e({type:"COMPLETE_PIN_SAVE"})}})),u.a,Object(h.a)(33),b.a,_.f)((function(e){const t=Object(v.b)();return s.a.createElement(x,Object.assign({},e,{boardPickerStopwatch:t}))}))},vxan:function(e,t,n){n.d(t,"a",(function(){return r}));var a=n("q1tI"),s=n("mvLR");function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function r(e){var t,n;return n=t=class extends a.Component{constructor(...e){super(...e),i(this,"makeCancelablePromise",(e,t)=>{if(t){const e=this.cancelCallbackMap[t];e&&(e(),delete this.cancelCallbackMap[t])}const{cancel:n,promise:a}=Object(s.a)(e);return t?this.cancelCallbackMap[t]=n:this.cancelCallbacks.push(n),a}),i(this,"cancelCallbacks",[]),i(this,"cancelCallbackMap",{})}componentWillUnmount(){[...Object.keys(this.cancelCallbackMap).map(e=>this.cancelCallbackMap[e]),...this.cancelCallbacks].forEach(e=>e()),this.cancelCallbacks=[],this.cancelCallbackMap={}}render(){return a.createElement(e,Object.assign({},this.props,{makeCancelablePromise:this.makeCancelablePromise}))}},i(t,"displayName",`WithPromiseCancellation(${e.displayName||e.name||"Component"})`),n}},w70y:function(e,t,n){n.d(t,"a",(function(){return p})),n.d(t,"b",(function(){return m}));var a=n("q1tI"),s=n.n(a),i=n("/MKj"),r=n("lSCD"),o=n.n(r),c=n("aK+E"),l=n("zLLH"),u=n("y19s"),d=n("Wer7");const h={};function p({acceptPrefetch:e,allowStale:t,enabledRouteRefresh:n,dangerouslyDisableFetch:s,options:r,name:o,headers:p,traceLoggerHandlerName:m}){const f=Object(i.useDispatch)(),b=Object(c.a)(r),g=Object(a.useRef)(),v=e=>(e[o]||h)[b]||h,{isPrefetch:_,nextBookmark:y,prefetchHasBeenRead:S}=Object(i.useSelector)(({resources:e})=>v(e.data)),C=Object(i.useSelector)(({resources:e})=>v(e.data).data),E=Object(i.useSelector)(({resources:e})=>v(e.data).error),x=Object(i.useSelector)(({resources:e})=>Boolean((e.fetching[o]||h)[b])),w=Object(i.useSelector)(({resources:e})=>Boolean((e.data[o]||h)[b])),{history:O}=Object(u.b)(),P=O&&"POP"!==O.action,D=Boolean(w&&n&&P&&!s),[j,k]=Object(a.useState)(D);void 0===g.current&&w&&P&&e&&_&&!S&&!s&&f(Object(d.h)(o,r));const I=Object(a.useCallback)(()=>{s||f(Object(d.a)(o,r,p,m))},[s,f,p,o,b,m]),R=Object(a.useCallback)(()=>{s||f(Object(d.d)(o,r,p,m))},[s,p,o,b,m]),T=Object(a.useCallback)(()=>{s||(I(),k(!0))},[s,I,k]),A=Object(a.useRef)({data:void 0,error:void 0,fetchMore:R,isAtEnd:!1,isFetching:!1,isLoaded:!1,isPrefetch:void 0,isRefreshing:!1,nextBookmark:void 0,prefetchHasBeenRead:void 0,refreshData:T});Object(a.useEffect)(()=>{!1!==t&&w&&!D||I()},[]),Object(a.useEffect)(()=>{void 0!==g.current&&b!==g.current&&I(),g.current=b},[b]);const M={data:C,error:E,fetchMore:R,isAtEnd:w&&!x&&y===l.a,isFetching:x,isLoaded:w,isPrefetch:_,isRefreshing:j,nextBookmark:y,prefetchHasBeenRead:S,refreshData:T};return Object(i.shallowEqual)(M,A.current)||(!j||D||Object(i.shallowEqual)(M.data,A.current.data)||(M.isRefreshing=!1,k(!1)),A.current=M),A.current}function m(e){const t=e.key;return function(n){function a(a){const{dangerouslyDisableFetch:i,options:r,key:c,...l}=e,u=p({...l,options:(o()(r)?r(a):r)||{},dangerouslyDisableFetch:!!i&&i(a)}),d={[t]:u};return s.a.createElement(n,Object.assign({},a,d))}return a.displayName=`withResourceExperimental[${e.name}](${n.displayName||n.name||""})`,a.WrappedComponent=n,a}}},y9Ij:function(e,t,n){n.d(t,"a",(function(){return m}));var a=n("q1tI"),s=n.n(a),i=(n("PNKV"),n("TSYQ")),r=n.n(i),o=n("lUXN"),c=n("Ye/N"),l=n("/5zs"),u=n("n6mq");function d(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const h=32,p=13;class m extends s.a.PureComponent{constructor(...e){super(...e),d(this,"handleKeyPress",e=>{e.charCode!==h&&e.charCode!==p||(e.preventDefault(),this.props.onClick(e))})}render(){const{disabled:e,icon:t,iconOnly:n,isCloseupPin:a,onClick:i,onSavedClick:d,requestContext:h,saveButtonType:p,saved:m,variant:f}=this.props;if(m&&"controlled"===p)return s.a.createElement(u.d,{disabled:!0,text:c.a._("Saved"),size:"sm"});if(m&&"classic"===p&&a&&h){const e=new l.b(h,"web_save_to_saved");if(e.check("enabled")||e.check("enabled_board"))return s.a.createElement(u.d,{accessibilityLabel:c.a._("Saved button","saveButton.saved.label","Saved state label on save button"),text:c.a._("Saved!","saveButton.saved","Saved state text on save button"),size:"md",color:"white",onClick:e.check("enabled_board")?d:({event:e})=>i(e)})}return n?s.a.createElement("div",{"data-test-id":"SaveButton"},s.a.createElement(u.o,{accessibilityLabel:c.a._("Save","Accessibility label for the save button","Accessibility label for the save button"),bgColor:"white",icon:"pin",onClick:({event:e})=>i(e),iconColor:"darkGray"})):s.a.createElement("div",{className:r()("SaveButton",e?"SaveButton--disabled":"SaveButton--enabled",{"SaveButton--lego":"lego"===f}),"data-test-id":"SaveButton",onClick:e?void 0:i,onKeyPress:e?void 0:this.handleKeyPress,role:"button",tabIndex:"0"},s.a.createElement("div",{className:r()("SaveButton__background",e?"SaveButton__background--disabled":"SaveButton__background--enabled",{"SaveButton__background--lego":"lego"===f})},s.a.createElement(u.c,{alignItems:"center",minHeight:40,dangerouslySetInlineStyle:{__style:{padding:"10px 14px"}},display:"flex"},s.a.createElement(o.a,{name:"web_save_button_no_icon"},({anyEnabled:n})=>t&&!n&&s.a.createElement(u.c,{dangerouslySetInlineStyle:{__style:{marginRight:3,marginLeft:-6}}},s.a.createElement(u.n,{accessibilityLabel:"",color:e?"gray":"white",icon:"pin",inline:!0,size:20}))),s.a.createElement(u.K,{color:e?"gray":"white",size:"lego"===f?"sm":"md",weight:"bold"},s.a.createElement("span",{className:r()("SaveButton__label",{"SaveButton__label--lego":"lego"===f})},c.a._("Save","Pin save button label","Pin save button label"))))))}}d(m,"defaultProps",{disabled:!1,icon:!0,saveButtonType:"classic",variant:"classic"})},yKES:function(e,t,n){n.d(t,"a",(function(){return l}));var a=n("q1tI"),s=n.n(a),i=n("Ye/N"),r=n("US8k"),o=n("n6mq");const c=24;function l({duration:e}){return s.a.createElement(o.c,{alignItems:"center",color:"transparentDarkGray",display:"flex",height:c,justifyContent:"center",paddingX:2,rounding:"pill"},s.a.createElement(o.n,{accessibilityLabel:i.a._("Video camera icon","Video camera indicator icon for a Pin","Video camera indicator icon for a Pin"),color:"white",icon:"video-camera"}),s.a.createElement(o.c,{marginStart:1},s.a.createElement(o.K,{color:"white",size:"sm",truncate:!0},Object(r.a)(e))))}}}]);
//# sourceMappingURL=https://sm.pinimg.com/webapp/js/PinSaveButtonCommon-f695d48fad73121d308f.mjs.map
